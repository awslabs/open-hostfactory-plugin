{
  "Type": "instant",
  "LaunchTemplateConfigs": [{
    "LaunchTemplateSpecification": {
      "LaunchTemplateId": "{{ launch_template_id }}",
      "Version": "{{ launch_template_version | default('$Latest') }}"
    },
    "Overrides": [
      {"InstanceType": "r6i.xlarge"},
      {"InstanceType": "r6a.xlarge"},
      {"InstanceType": "r5.xlarge"},
      {"InstanceType": "r5n.xlarge"},
      {"InstanceType": "r5a.xlarge"},
      {"InstanceType": "r5d.xlarge"},
      {"InstanceType": "r6i.2xlarge"},
      {"InstanceType": "r6a.2xlarge"},
      {"InstanceType": "r5.2xlarge"},
      {"InstanceType": "r5n.2xlarge"},
      {"InstanceType": "r5a.2xlarge"},
      {"InstanceType": "r5d.2xlarge"},
      {"InstanceType": "r6i.4xlarge"},
      {"InstanceType": "r6a.4xlarge"},
      {"InstanceType": "r5.4xlarge"},
      {"InstanceType": "r5n.4xlarge"},
      {"InstanceType": "r5a.4xlarge"},
      {"InstanceType": "r5d.4xlarge"},
      {"InstanceType": "r6i.8xlarge"},
      {"InstanceType": "r5.8xlarge"},
      {"InstanceType": "r5n.8xlarge"},
      {"InstanceType": "r5a.8xlarge"},
      {"InstanceType": "r5d.8xlarge"},
      {"InstanceType": "r5.12xlarge"},
      {"InstanceType": "r5a.12xlarge"},
      {"InstanceType": "r5d.12xlarge"},
      {"InstanceType": "r5.16xlarge"},
      {"InstanceType": "r5d.16xlarge"},
      {"InstanceType": "r5dn.24xlarge"},
      {"InstanceType": "r6i.32xlarge"},
      {"InstanceType": "r6id.32xlarge"},
      {"InstanceType": "r6i.48xlarge"},
      {"InstanceType": "m6i.xlarge"},
      {"InstanceType": "m6a.xlarge"},
      {"InstanceType": "m5.xlarge"},
      {"InstanceType": "m5n.xlarge"},
      {"InstanceType": "m5a.xlarge"},
      {"InstanceType": "m5d.xlarge"},
      {"InstanceType": "m6i.2xlarge"},
      {"InstanceType": "m6a.2xlarge"},
      {"InstanceType": "m5.2xlarge"},
      {"InstanceType": "m5n.2xlarge"},
      {"InstanceType": "m5a.2xlarge"},
      {"InstanceType": "m5d.2xlarge"},
      {"InstanceType": "m6i.4xlarge"},
      {"InstanceType": "m6a.4xlarge"},
      {"InstanceType": "m5.4xlarge"},
      {"InstanceType": "m5n.4xlarge"},
      {"InstanceType": "m5a.4xlarge"},
      {"InstanceType": "m5d.4xlarge"},
      {"InstanceType": "m6i.8xlarge"},
      {"InstanceType": "m5.8xlarge"},
      {"InstanceType": "m5n.8xlarge"},
      {"InstanceType": "m5a.8xlarge"},
      {"InstanceType": "m5d.8xlarge"},
      {"InstanceType": "m5.12xlarge"},
      {"InstanceType": "m5a.12xlarge"},
      {"InstanceType": "m5d.12xlarge"},
      {"InstanceType": "m5.16xlarge"},
      {"InstanceType": "m5d.16xlarge"},
      {"InstanceType": "m5dn.24xlarge"},
      {"InstanceType": "m6i.32xlarge"}
    ]
  }],
  "TargetCapacitySpecification": {
    "TotalTargetCapacity": "{{ requested_count }}",
    "DefaultTargetCapacityType": "spot",
    "OnDemandTargetCapacity": "{{ on_demand_capacity | default(1) }}",
    "OnDemandAllocationStrategy": "prioritized",
    "SpotAllocationStrategy": "price-capacity-optimized"
  },
  "TagSpecifications": [{
    "ResourceType": "fleet",
    "Tags": [
      {"Key": "Name", "Value": "hpc-price-optimized-fleet-{{ request_id }}"},
      {"Key": "RequestId", "Value": "{{ request_id }}"},
      {"Key": "TemplateId", "Value": "{{ template_id }}"},
      {"Key": "CreatedBy", "Value": "{{ package_name }}"},
      {"Key": "WorkloadType", "Value": "hpc"},
      {"Key": "AllocationStrategy", "Value": "price-capacity-optimized"}
    ]
  }]
}
